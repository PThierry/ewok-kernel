\documentclass{minimal}
\usepackage{tikz}
%%%<
\usepackage{verbatim}
\usepackage[active,tightpage]{preview}
\PreviewEnvironment{tikzpicture}
\setlength\PreviewBorder{5pt}%
%%%>

\begin{document}
\begin{tikzpicture}
% app
\draw[fill=gray!50] (0,4.2) rectangle (4,6) node [midway] {$application$};
% libs
\draw[fill=gray!20] (4.2,5.2) rectangle (8,6) node [midway] {libs};
%drivers
\draw[fill=gray!10] (4.2,4.2) rectangle (8,5) node [midway] {drivers};
% libstd
\draw[fill=red!10] (0,3.2) rectangle (8,4) node [midway] {libstd};
%%% user / supervisor separation
\draw[red,dashed] (0,3.1) -- (8,3.1);
% kernel
\draw[fill=blue!40] (0,1.2) rectangle (8,3) node [midway] {kernel};
% bsp
\draw[fill=blue!20] (0,0) rectangle (8,1) node [midway] {BSP};
\end{tikzpicture}
\end{document}
